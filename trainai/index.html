
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../assets/">
      
      
        <link rel="next" href="../cicd/">
      
      
      <link rel="icon" href="../images/IBM_logo.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.10">
    
    
      
        <title>Training ML Models - watsonx MLOps Workshop</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e359304.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,300i,400,400i,700,700i%7CIBM+Plex+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"IBM Plex Sans";--md-code-font:"IBM Plex Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#creating-an-ai-use-case" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="watsonx MLOps Workshop" class="md-header__button md-logo" aria-label="watsonx MLOps Workshop" data-md-component="logo">
      
  <img src="../images/IBM_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            watsonx MLOps Workshop
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Training ML Models
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../prereq1/" class="md-tabs__link">
          
  
  Pre-requirements

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  Labs

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../demo-assistant/" class="md-tabs__link">
          
  
  Additional Topics

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="watsonx MLOps Workshop" class="md-nav__button md-logo" aria-label="watsonx MLOps Workshop" data-md-component="logo">
      
  <img src="../images/IBM_logo.png" alt="logo">

    </a>
    watsonx MLOps Workshop
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pre-requirements
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Pre-requirements
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../prereq1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating an Environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../prereq2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuring the Environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assets used
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    1. Train AI
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    1. Train AI
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-an-ai-use-case" class="md-nav__link">
    <span class="md-ellipsis">
      Creating an AI Use Case
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-preparation-with-data-refinery" class="md-nav__link">
    <span class="md-ellipsis">
      Data Preparation with Data Refinery
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#train-autoai-model-for-churn-prediction" class="md-nav__link">
    <span class="md-ellipsis">
      Train AutoAI Model for Churn Prediction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#track-your-model-in-the-ai-use-case" class="md-nav__link">
    <span class="md-ellipsis">
      Track your Model in the AI use case
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy-your-model-for-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Deploy your Model for testing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#track-your-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      Track your deployment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#train-churn-prediction-model-with-jupyter-notebook" class="md-nav__link">
    <span class="md-ellipsis">
      Train Churn Prediction Model with Jupyter Notebook
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cicd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. MLOps CI/CD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. AI Pipelines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../monitorai/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Monitor AI
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Additional Topics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Additional Topics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../demo-assistant/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual Assistant Demo
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-an-ai-use-case" class="md-nav__link">
    <span class="md-ellipsis">
      Creating an AI Use Case
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-preparation-with-data-refinery" class="md-nav__link">
    <span class="md-ellipsis">
      Data Preparation with Data Refinery
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#train-autoai-model-for-churn-prediction" class="md-nav__link">
    <span class="md-ellipsis">
      Train AutoAI Model for Churn Prediction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#track-your-model-in-the-ai-use-case" class="md-nav__link">
    <span class="md-ellipsis">
      Track your Model in the AI use case
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy-your-model-for-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Deploy your Model for testing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#track-your-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      Track your deployment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#train-churn-prediction-model-with-jupyter-notebook" class="md-nav__link">
    <span class="md-ellipsis">
      Train Churn Prediction Model with Jupyter Notebook
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>1. Train AI</h1>

<div><p>In this lab, you will assume the role of a Data Scientist, who typically trains and evaluates AI models. The following data sets will be used, download them now:</p>
<ul>
<li>
<p><a href="../assets/data/customer_personal_info_simplified.csv"><strong>customer_personal_info_simplified</strong></a>: This dataset captures personal information of the customers such as gender, marital status, income, age, and similar data.</p>
</li>
<li>
<p><a href="../assets/data/customer_data_transactions.csv"><strong>customer_data_transactions</strong></a>: This dataset captures the transaction data for customers.</p>
</li>
<li>
<p><a href="../assets/data/customer_churn_labels.csv"><strong>customer_churn_labels</strong></a>: This dataset captures information about whether a specific customer did churn or not.</p>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you have issues downloading the data assets, try downloading them from the section <a href="../assets/">Assets used</a>, as these datasets are included there too.</p>
</div>
<h2 id="creating-an-ai-use-case">Creating an AI Use Case</h2>
<p>The government of ML Models is managed from AI Use Cases. These AI Use Cases document the whole lifecycle of your models, from the initial planning to the monitoring of models in Production.</p>
<p>This capability is provided by either the service FactSheets or watsonx.governance.</p>
<ol>
<li>
<p>Go to menu <strong>AI Governance &gt; AI use cases</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/aiUseCases.png"></p>
</li>
<li>
<p>Click <strong>New AI use case</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/createUseCase.png"></p>
</li>
<li>
<p>Insert the following information to create your AI Use Case for predicting your customers' churn:</p>
<ul>
<li><strong>Name</strong>: "&lt;YourUser&gt; Churn Prediction" (for example: user0 Churn Prediction)</li>
<li><strong>Risk Level</strong>: Set whatever risk level you want for this use case</li>
<li><strong>Inventory</strong>: AI_inventory</li>
<li><strong>Purpose</strong>: "Predict if customers are going to churn"</li>
<li><strong>Status</strong>: "Awaiting development"</li>
<li><strong>Tags</strong>: "Churn"</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Note all the available values in Status. This field documents all the lifecycle stages</p>
</div>
<p>Then click <strong>Create</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/newUseCase.png"></p>
</li>
<li>
<p>Your new AI Use Case has been created. All the deployment, training, promoting, and monitoring actions related to this use case will be documented here. Click <strong>Lifecycle</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/useCase.png"></p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>You could create different approaches to this use case, and track your models in the approach each of them is using. In this workshop we'll just use the Default approach, so no additional action is needed.</p>
</div>
<p><img alt="Screenshot" src="../images/trainai/defaultApproach.png"></p>
</li>
</ol>
<h2 id="data-preparation-with-data-refinery">Data Preparation with Data Refinery</h2>
<p>Before creating your ML model, you will prepare data using <a href="https://www.ibm.com/docs/en/cloud-paks/cp-data/latest?topic=services-data-refinery">Data Refinery</a>, a visual UI-based tool that enables users to interactively discover, cleanse and transform data with over 100 built-in operations.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>In IBM Cloud Pak for Data, a <strong>Project</strong> is how you organize your resources to achieve a particular goal. A project allows for high-level isolation, enabling users to package their project assets independently for different use cases or departments. Your project resources can include data, collaborators, scripts, and analytic assets like notebooks and models.</p>
</div>
<ol>
<li>
<p>Log in CP4D with your assigned user. Contact your instructor if you haven't been assigned one.</p>
</li>
<li>
<p>Go to the Projects section by clicking the Navigation menu and selecting <strong>Projects &gt; All projects</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/Projects.png"></p>
</li>
<li>
<p>Click on <strong>New project</strong> to create a new project.</p>
<p><img alt="Screenshot" src="../images/trainai/CreateProjects.png"></p>
</li>
<li>
<p>Select the <strong>Create an empty project</strong> option.</p>
<p><img alt="Screenshot" src="../images/trainai/CreateEmptyProject.png"></p>
</li>
<li>
<p>Insert the following Project Name: <strong>&lt;YourUser&gt; Customer Churn Prediction</strong> where <em><youruser></youruser></em> is your username. For example: "user0 Customer Churn Prediction". Then Click <strong>Create</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/CreateProject.png"></p>
</li>
<li>
<p>Now that the project is created, the Data Scientist will shop for relevant data assets that can help them with training this AI model for customer churn prediction. Click the <strong>Find and add data</strong> icon.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>In a real case, the Data Scientist would search for relevant assets in CP4D Catalogs. However, for simplicity sake, we'll use the 3 datasets referenced earlier.</p>
</div>
<p><img alt="Screenshot" src="../images/trainai/UploadAssetToProject.png"></p>
</li>
<li>
<p>Either drag and drop or browse the <a href="../assets/data/customer_personal_info_simplified.csv">customer_personal_info_simplified.csv</a> file that you downloaded into the <strong>Drop files here or browse</strong> box. Wait for the file to upload to the project. Then, repeat it for the other csv files:</p>
<ul>
<li><a href="../assets/data/customer_data_transactions.csv"><strong>customer_data_transactions.csv</strong></a></li>
<li><a href="../assets/data/customer_churn_labels.csv"><strong>customer_churn_labels.csv</strong></a></li>
</ul>
<p><img alt="Screenshot" src="../images/trainai/DropDataFilesToProject.png"></p>
</li>
<li>
<p>Verify the 3 CSV files have been uploaded to your project by clicking the <strong>Assets</strong> tab. You should see all 3 files under the Data assets section:</p>
<ul>
<li>customer_data_transactions.csv</li>
<li>customer_churn_labels.csv</li>
<li>customer_personal_info_simplified.csv</li>
</ul>
<p><img alt="Screenshot" src="../images/trainai/CsvUploadProject.png"></p>
</li>
<li>
<p>Next step is to shape the data to get it ready to be used for training ML models.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Cloud Pak for Data supports multiple approaches for data shaping and transformation. In this lab, you will use <a href="https://www.ibm.com/docs/en/cloud-paks/cp-data/latest?topic=data-refining">Data Refinery</a> to cleanse and shape the data with a graphical flow editor and create a joined data set of the Customer Data asset and the labeled churn data set.</p>
</div>
<p>Click <strong>New Asset</strong> and select <strong>Data Refinery</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/NewAsset.png"></p>
<p><img alt="Screenshot" src="../images/trainai/DataRefineryAsset.png"></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Alternatively, you could access Data Refinery by clicking on the open and close list of options menu (3 vertical dots) next to a data asset in your project and then selecting <strong>Refine</strong>.</p>
</div>
</li>
<li>
<p>Select <strong>Data asset</strong> and then select the <strong>customer_data_transactions.csv</strong> data set and click <strong>Select</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/DataRefineryDataAssetSelection.png"></p>
</li>
<li>
<p>This loads the dataset in Data Refinery. Note the tabs Data, Profile, and Visualizations.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the Profile and Visualizations tabs are grayed out, wait for some time as the asset is being loaded.</p>
</div>
<ul>
<li>
<p>The <strong>Data</strong> tab displays the data and enables you to apply a number of common operations to cleanse and shape the data in a graphical editor. It also supports deploying R library operations, functions, and logical operators via the command line.</p>
</li>
<li>
<p>The <strong>Profile</strong> tab shows useful summary statistics including a histogram of each of the data fields. This is useful to understand the statistical distribution of the data as well as potential skew that may exist.</p>
</li>
<li>
<p>The <strong>Visualizations</strong> tab provides over 20 customizable charts to provide perspective and insights into the data.</p>
</li>
</ul>
<p><img alt="Screenshot" src="../images/trainai/RefineDataView.png"></p>
</li>
<li>
<p>Change the <em>ID</em> column type from <em>Integer</em> to <em>String</em>. This is needed because in the next step when you apply a join of this data and the other data sets, need the column types to match. To do so, click on the <strong>3-dot menu</strong> next to the ID column, select <strong>Convert column type</strong> and then select <strong>String</strong> type and click <strong>Apply</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/ConvertColumnTypeToString.png"></p>
<p><img alt="Screenshot" src="../images/trainai/ConvertColumnTypeToString2.png"></p>
</li>
<li>
<p>Next, you will add a step to join this data set with the <em>customer_personal_info_simplified.csv</em> dataset to capture additional features that may impact the likelihood of a customer to churn. Click the <strong>New Step</strong> button which will open the operations column, scroll down to find the Join operation and click <strong>Join</strong>. You can also type Join in the Search operations field and it will filter the list of operations to find Join.</p>
<p><img alt="Screenshot" src="../images/trainai/AddANewStep.png"></p>
<p><img alt="Screenshot" src="../images/trainai/AddJoin.png"></p>
</li>
<li>
<p>On the Join operations window, keep the type of join as <em>"Left join"</em> then click <strong>Add data set</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/AddLeftJoin.png"></p>
</li>
<li>
<p>On the Data set page, click <strong>Data asset</strong>, select the <strong>customer_personal_info_simplified.csv</strong> dataset and click <strong>Apply</strong>. </p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In case you’re not familiar with the Left Join operation, Data Refinery provides an explanation of what that operation does; specifically, a Left Join returns all rows in the original data set and returns only the matching rows in the joining dataset.</p>
</div>
<p><img alt="Screenshot" src="../images/trainai/DataSetJoin.png"></p>
<p>Back on the Join operation window, click <strong>Select column</strong> to specify <strong>ID</strong> as the field to use for joining the two data sets. Then click <strong>Next</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/DataSetJoinConfig.png"></p>
<p><img alt="Screenshot" src="../images/trainai/DataSetJoinKeys.png"></p>
</li>
<li>
<p>On the next window, it shows all the fields that will result from the join operation. At this point, you can remove fields you do not wish to include in the final data set. For this lab, keep all the fields selected and click <strong>Apply</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/DataSetJoinAttributes.png"></p>
</li>
<li>
<p>Repeat the process (previous 3 steps) to apply a join operation on the resulting data set and the <em>customer_churn_labels.csv</em> dataset. The data set to join is <strong>customer_churn_labels.csv</strong>, and the join field is <strong>ID</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/DataSetJoin2.png"></p>
</li>
<li>
<p>Note that the Data Refinery flow has been augmented with all the executed operations. As you perform more operations to shape the data, they get added to the Data Refinery flow. For this lab, we will just perform the Join operations but typically, you’d perform several other operations to transform the data and make it ready for analytics insights and training machine learning models.</p>
<p><img alt="Screenshot" src="../images/trainai/CompleteSetOfSteps.png"></p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>In a real-case scenario, data typically requires several more operations to cleanse by removing nulls, filtering rows with missing data, aggregating data across fields, and/or applying a number of different operations. In this lab, the dataset we’re using is already in good shape and the only operations you will apply is to join the customer data (which was already a join of customer personal information and transaction data) and labeled churn data set.</p>
</div>
<p>Take a minute to browse the set of supported operations.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><a href="https://www.youtube.com/watch?v=LRzochwHg7Y">This video</a> and <a href="https://www.ibm.com/docs/en/cloud-paks/cp-data/latest?topic=data-refine">this tutorial</a> provide more examples and details of operations for data transformation using Data Refinery.</p>
</div>
</li>
<li>
<p>Change the output file name. To do so, click the <strong>Settings</strong> button.</p>
<p><img alt="Screenshot" src="../images/trainai/Settings.png"></p>
</li>
<li>
<p>Go to the tab <strong>Target data set</strong>. Then click <strong>Edit properties</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/TargetDataSet.png"></p>
</li>
<li>
<p>In the <strong>Data asset name</strong> field, insert <strong><em>CUSTOMER_DATA_ready</em></strong>. Then click <strong>Save</strong> and <strong>Apply</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/DataAssetName.png">
<img alt="Screenshot" src="../images/trainai/ApplyTargetDataSet.png"></p>
</li>
<li>
<p>Once you’ve applied all the operations to transform the data and configured the output, next step is to save the flow and create a job to apply this data refinery flow against the complete data set. To do so, click on <strong>Save and create a job</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/SaveAndCreateAJob.png"></p>
</li>
<li>
<p>Provide a Name for the job <strong>&lt;YourUser&gt; drjob</strong>, and click <strong>Next</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/CreateAJobConfig.png"></p>
<p>On the <strong>Configure</strong> tab, review the <strong>Environment</strong> and keep the default selection <em>Default Data Refinery XS</em>, then click <strong>Next</strong>. For jobs that require more resources, you can select a larger Environment to run the job.</p>
<p><img alt="Screenshot" src="../images/trainai/CreateAJobConfig2.png"></p>
<p>On the <strong>Schedule</strong> tab, keep the Schedule slider set to off, and click <strong>Next</strong>. In this lab, we don’t need to run the data refinery job at a given schedule but we’ll manually run it as needed and that is why we kept the default selection as off.</p>
<p><img alt="Screenshot" src="../images/trainai/CreateAJobConfig3.png"></p>
<p>On the Notify tab, keep the Notification off as default. Click <strong>Next</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/CreateAJobConfig4.png"></p>
<p>On the <strong>Review and create</strong> tab, review the job details and click <strong>Create and run</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/RunJobAndSaveFlow.png"></p>
</li>
<li>
<p>After you click Create and Run, navigate to the jobs view to monitor progress by clicking on the Navigation menu and selecting <strong>Jobs</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/GoToJobs.png"></p>
</li>
<li>
<p>On the Jobs page, you can filter the view by selecting whether you want to look at <strong>Active runs</strong>, <strong>Jobs with active runs</strong>, <strong>Jobs with finished runs</strong>, or <strong>Finished runs</strong>. Feel free to filter the different views to see the results. Initially, the job will appear in the view <strong>Jobs with active runs</strong> and when it completes, the job will appear in the view <strong>Jobs with finished runs</strong>. Feel free to click on the job name and review the details and status of the run(s).</p>
<p><img alt="Screenshot" src="../images/trainai/ViewJobs.png"></p>
</li>
<li>
<p>Navigate back to the project and click the <strong>Assets</strong> tab. Note the Data Refinery flow, <strong><em>customer_data_transactions.csv_flow</em></strong> which is now a project asset and the newly created data asset, <strong><em>CUSTOMER_DATA_ready.csv</em></strong>, which was created by running the Data Refinery flow that joined the customer data transactions with the customer personal information and churn labels data sets. Click the <strong><em>CUSTOMER_DATA_ready.csv</em></strong> (red arrow) asset to review the data.</p>
<p><img alt="Screenshot" src="../images/trainai/ViewJobResult.png"></p>
</li>
</ol>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>At this point, you have collected data from various sources and leveraged Data Refinery to shape the data using a graphical editor. Now, the data is ready to be used for training a machine learning model for predicting the likelihood of a customer to churn based on his/her demographic and transaction data.</p>
</div>
<h2 id="train-autoai-model-for-churn-prediction">Train AutoAI Model for Churn Prediction</h2>
<p>In this section, we illustrate how to leverage AutoAI to quickly train multiple AI models for churn prediction and select the pipeline that delivers best performance.</p>
<ol>
<li>
<p>Navigate back to your project and click <strong>Assets</strong> tab, click <strong>New asset +</strong> and select <strong>AutoAI</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/NewAsset2.png"></p>
<p><img alt="Screenshot" src="../images/trainai/AutoAIAsset.png"></p>
</li>
<li>
<p>Provide the following name to your AutoAI experiment: <strong>&lt;YourUser&gt;_autoai_churn_prediction</strong>, keep the default Compute configuration and click Create.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You could select a different configuration if you needed to assign more resources for your AutoAI experiment.</p>
</div>
<p><img alt="Screenshot" src="../images/trainai/ConfigureAutoAI.png"></p>
</li>
<li>
<p>On the AutoAI add data sources page, click the <strong>Select from project</strong> button since you will be using the dataset you had created earlier with Data Refinery.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You could also click Browse to upload data from your local machine.</p>
</div>
<p><img alt="Screenshot" src="../images/trainai/AddDataSourcesFromProject.png"></p>
</li>
<li>
<p>Click Data asset and select the checkbox to select the <strong>CUSTOMER_DATA_ready</strong> dataset. Then click <strong>Select asset</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/SelectCustomerDataReady.png"></p>
</li>
<li>
<p>On the next page, you will see the selected dataset and you will be prompted to select whether you want to Create a time series forecast which is supported by AutoAI. Click <strong>No</strong> since customer churn prediction is a classification use case and not a time series forecasting use case.</p>
<p>Once you click No, you will get the option to select which column to predict. Scroll down the list to select the <strong>CHURN</strong> column. At this point, we have provided the data set, indicated it is a classification use case and selected the prediction column. Click <strong>Run experiment</strong> (blue button) to kick off the AutoAI run.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Note that you can click the Experiment settings to review the default settings and change some of the configurations if you wish. Review those settings as they’re very informative.</p>
</div>
<p><img alt="Screenshot" src="../images/trainai/PredictionConfiguration.png"></p>
</li>
<li>
<p>AutoAI runs for a few minutes on this dataset and produces a number of pipelines as shown in figure below including training/test data split, data preprocessing, feature engineering, model selection, and hyperparameter optimization. You can dig deeper into any of the pipelines to better understand feature importance, the resulting metrics, the selected model, and any applied feature transformation.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>While waiting for AutoAI’s run to complete, you could review the <a href="https://www.ibm.com/docs/en/cloud-paks/cp-data/latest?topic=models-autoai">AutoAI Documentation</a>.</p>
<p>Specifically, review the <a href="https://www.ibm.com/docs/en/cloud-paks/cp-data/latest?topic=autoai-implementation-details">AutoAI Implementation Details</a> to understand what algorithms are supported, what data transformations are applied and what metrics can be optimized.</p>
</div>
<p><img alt="Screenshot" src="../images/trainai/AutoAIModelPrediction.png">  </p>
<p>The AutoAI run will take 4-5 minutes to complete. Once complete, please spend a few minutes exploring the dashboard:</p>
<ul>
<li>
<p>Switch between the <strong><em>Experiment details</em></strong> and the <strong><em>Legend</em></strong> information (annotated with red rectangles in previous figure) to better understand the generated Relationship map.</p>
</li>
<li>
<p>Switch between <strong><em>Cross Validation</em></strong> and <strong><em>Holdout</em></strong> results by clicking the icon next to Cross Validation (annotated with red oval in previous figure) to see how the pipeline ranking changed depending on which data is being evaluated.</p>
</li>
<li>
<p>Swap the view between the <strong><em>Relationship map</em></strong> and the <strong><em>Progress map</em></strong> (annotated with blue oval in previous figure) to see the different views of the AutoAI pipeline creation process.</p>
</li>
<li>
<p>Click on the top pipeline (annotated with blue rectangle in previous figure) to review the details for that pipeline. AutoAI reports several valuable evaluation criteria like several performance metrics (Accuracy, Area under ROC, Precision, Recall, F1) as well asthe confusion matrix, Precision Recall Curve, and feature importance. If the pipeline also included feature engineering (or feature transformation), the pipeline details will explain what transformations were applied. Close the pipeline details window by clicking x top right of window.</p>
</li>
</ul>
<p>After reviewing the trained pipelines, you can decide which one you’d like to save as a model to deploy. Assuming you select the first pipeline, mouse over the first pipeline and click <strong>Save as</strong> (annotated with red arrow in figure above).</p>
</li>
<li>
<p>On the Save As page, select <strong>Model</strong>, keep the default name, and click <strong>Create</strong>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Note that you could also save the pipeline as a Notebook which you can customize further.</p>
</div>
<p><img alt="Screenshot" src="../images/trainai/AutoAISaveModel.png"></p>
</li>
</ol>
<h2 id="track-your-model-in-the-ai-use-case">Track your Model in the AI use case</h2>
<ol>
<li>
<p>Navigate back to the project assets by clicking your project's name and then clicking the <strong>Assets</strong> tab.</p>
<p>Click on the name of your saved model <strong>&lt;YourUser&gt;_autoai_churn_prediction - P5 Extra Trees Classifier - Model</strong> to open it.</p>
<p><img alt="Screenshot" src="../images/trainai/openModel.png"></p>
</li>
<li>
<p>Feel free to check all the information available now; as the lifecycle continues, more sections will be populated.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>This view contains all the governance information of your model. It includes information about the use case, how the model was trained, which data was used to train it, the evaluations of the model, the monitoring alerts...</p>
</div>
<p><img alt="Screenshot" src="../images/trainai/factsheet.png"></p>
</li>
<li>
<p>Click <strong>Track in AI use case</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/trackUseCase.png"></p>
</li>
<li>
<p>Select your AI Use Case then click <strong>Next</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/defineUseCase.png"></p>
</li>
<li>
<p>You'll use the Default approach. You could've created different approaches for the use case. Click <strong>Next</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/approach.png"></p>
</li>
<li>
<p>You can set a version number to this specific model. In this case, it's not been tested yet, so select version 0.0.1. Then click <strong>Next</strong></p>
<p><img alt="Screenshot" src="../images/trainai/modelVersion.png"></p>
</li>
<li>
<p>Click <strong>Track asset</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/clickTrackAsset.png"></p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The information of your model indicates that the model is in the Development phase, as it has not been deployed for testing yet.</p>
</div>
<p><img alt="Screenshot" src="../images/trainai/factsheet-2.png"></p>
</li>
<li>
<p>Check your AI Use Case. Go to menu <em>AI Governance &gt; AI use cases</em>*.</p>
<p><img alt="Screenshot" src="../images/trainai/aiUseCases.png"></p>
</li>
<li>
<p>Then open your use case.</p>
<p><img alt="Screenshot" src="../images/trainai/openUseCase.png"></p>
</li>
<li>
<p>Go to the <strong>Lifecycle</strong> tab. This tab shows which assets are being used in each stage of the model's lifecycle. Note that your trained model has been added to the Develop step. Besides, all available model versions are shown in this view.</p>
<p><img alt="Screenshot" src="../images/trainai/lifecycleTab.png"></p>
</li>
</ol>
<h2 id="deploy-your-model-for-testing">Deploy your Model for testing</h2>
<p>Let's promote the trained model to a UAT (Testing) Deployment Space, then deploy it so it's ready to be called for testing.</p>
<ol>
<li>
<p>Navigate back to the project assets by clicking your project's name and then clicking the <strong>Assets</strong> tab.</p>
<p>Click on the menu of your saved model <strong>&lt;YourUser&gt;_autoai_churn_prediction - P5 Extra Trees Classifier - Model</strong> then click <strong>Promote to space</strong>. Note that the name of your model may be different.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note that the name of your model may be different. Even a different classifier may have been used in your case.</p>
</div>
<p><img alt="Screenshot" src="../images/trainai/AutoAIModel.png"></p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p><strong>Deployment spaces</strong> allow you to create deployments for machine learning models and functions and view and manage all of the activity and assets for the deployments, including data connections and connected data assets.</p>
<p>A deployment space is not associated with a project. You can deploy assets from multiple projects to a space, and you can deploy assets to more than one space. For example, you might have a <strong>Test</strong> space for evaluating deployments, and a <strong>Production</strong> space for deployments you want to deploy in business applications.</p>
</div>
</li>
<li>
<p>On the Promote to space page, select the <strong>churnUATspace</strong> from Target Space drop-down. Keep the default selected version (Current) and click <strong>Promote</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/PromoteToDevelopmentSpace.png"></p>
</li>
<li>
<p>Once the model is successfully promoted to the deployment space, you will see a notification message. Click on the <strong>deployment space</strong> link to navigate to the deployment space.</p>
<p><img alt="Screenshot" src="../images/trainai/CheckDeploymentSpace.png"></p>
</li>
<li>
<p>On the <strong>churnUATspace</strong> deployment space page, your AutoAI model <strong>&lt;YourUser&gt;_autoai_churn_prediction – P7 XGBClassifier</strong> is ready to be deployed for consumption. Click on the 3-dot menu next to the model then click <strong>Deploy</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/DeployModel.png"></p>
</li>
<li>
<p>On the <strong>Create a deployment</strong> page, select <strong>Online</strong>, add the Name <strong>&lt;YourUser&gt;_autoai_churn</strong> and click <strong>Create</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/CreateOnlineDeployment.png"></p>
</li>
<li>
<p>Click on the <strong>Deployments</strong> tab and wait until the deployment status changes to Deployed. Then click on the deployed model name <strong>&lt;YourUser&gt;_autoai_churn</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/DeployOnlineDeployment.png"></p>
</li>
<li>
<p>On the model page API reference tab, review the model Endpoint and the various Code snippets (in different coding languages) to illustrate how to make an API call to the deployed model. Then select the Test tab, click on the <strong>Provide input data as JSON</strong> icon, paste the following JSON sample in the <strong>Enter input data</strong> window and click <strong>Predict</strong> (blue button).</p>
</li>
</ol>
<div class="admonition danger">
<p class="admonition-title">IMPORTANT</p>
<p>Use the copy button in the code snippet below to keep the right format of the content when pasting.</p>
</div>
<div class="copy highlight"><pre><span></span><code><span class="p">{</span>
<span class="nt">"input_data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="p">{</span>
<span class="nt">"fields"</span><span class="p">:</span>
<span class="p">[</span><span class="s2">"ID"</span><span class="p">,</span><span class="s2">"LONGDISTANCE"</span><span class="p">,</span><span class="s2">"INTERNATIONAL"</span><span class="p">,</span><span class="s2">"LOCAL"</span><span class="p">,</span><span class="s2">"DROPPED"</span><span class="p">,</span><span class="s2">"PAYMETHOD"</span><span class="p">,</span><span class="s2">"LOCALBILLTYPE"</span><span class="p">,</span><span class="s2">"LONGDISTANCEBILLTYPE"</span><span class="p">,</span><span class="s2">"USAGE"</span><span class="p">,</span><span class="s2">"RATEPLAN"</span><span class="p">,</span><span class="s2">"GENDER"</span><span class="p">,</span><span class="s2">"STATUS"</span><span class="p">,</span><span class="s2">"CHILDREN"</span><span class="p">,</span><span class="s2">"ESTINCOME"</span><span class="p">,</span><span class="s2">"CAROWNER"</span><span class="p">,</span><span class="s2">"AGE"</span><span class="p">],</span>
<span class="nt">"values"</span><span class="p">:[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s2">"Auto"</span><span class="p">,</span><span class="s2">"FreeLocal"</span><span class="p">,</span><span class="s2">"Standard"</span><span class="p">,</span><span class="mi">89</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="s2">"F"</span><span class="p">,</span><span class="s2">"M"</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">23000</span><span class="p">,</span><span class="s2">"N"</span><span class="p">,</span><span class="mi">45</span><span class="p">]]</span>
<span class="p">}</span>
<span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p><img alt="Screenshot" src="../images/trainai/TestOnlineDeploymentPrediction.png">
<img alt="Screenshot" src="../images/trainai/TestOnlineDeploymentPrediction2.png"></p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The deployed model will predict the likelihood of the user to churn given the specific values for the various features. The model returns the predicted churn label as “T” (true) or “F” (false) and the probability of that prediction which effectively expresses the likelihood of that user to churn (or not). A “T” label returned by the model indicates the user is likely to churn and the corresponding probability.</p>
<p>These probabilities can be used in conjunction with the predicted label to better serve customers on a more granular basis. Your application can be customized to make decisions based on the predicted label and the probabilities of that prediction.</p>
</div>
<div class="admonition danger">
<p class="admonition-title">IMPORTANT</p>
<p>There's a known issue in the current version of the workshop environment that prevents the AI Use Case from automatically register that the model was deployed in a Test Space. Follow this workaround:</p>
<ol>
<li>
<p>Close the prediction results window by clicking the <strong>x</strong> button:</p>
<p><img alt="Screenshot" src="../images/trainai/closePrediction.png"></p>
</li>
<li>
<p>Then go back to the Deployment Space using the breadcrumb menu:</p>
<p><img alt="Screenshot" src="../images/trainai/goToSpace.png"></p>
</li>
<li>
<p>Click your model to open it:</p>
<p><img alt="Screenshot" src="../images/trainai/clickModel.png"></p>
</li>
<li>
<p>Go to the <strong>AI Factsheet</strong> tab then click <strong>Untrack</strong>:</p>
<p><img alt="Screenshot" src="../images/trainai/untrack.png"></p>
</li>
<li>
<p>Click <strong>Untrack</strong>:</p>
<p><img alt="Screenshot" src="../images/trainai/untrack-2.png"></p>
</li>
<li>
<p>Now click <strong>Track in AI use case</strong> to enable tracking again:</p>
<p><img alt="Screenshot" src="../images/trainai/track-2.png"></p>
</li>
<li>
<p>Choose your AI Use Case and follow the same steps as you did before. Now, the <strong>Test</strong> step should be enabled because a Testing Deployment was detected:</p>
<p><img alt="Screenshot" src="../images/trainai/nowItWorks.png"></p>
</li>
</ol>
</div>
<h2 id="track-your-deployment">Track your deployment</h2>
<ol>
<li>
<p>Go to the <strong>AI use cases</strong> menu.</p>
<p><img alt="Screenshot" src="../images/trainai/aiUseCases.png"></p>
</li>
<li>
<p>Open your use case.</p>
<p><img alt="Screenshot" src="../images/trainai/openUseCase.png"></p>
</li>
<li>
<p>Go to the <strong>Lifecycle</strong> tab. Note that the AI Use Case has advanced to the Test step. The available Test deployments are shown in their Deployment Space:</p>
<p><img alt="Screenshot" src="../images/trainai/testStep.png"></p>
</li>
</ol>
<h2 id="train-churn-prediction-model-with-jupyter-notebook">Train Churn Prediction Model with Jupyter Notebook</h2>
<p>In this section, we illustrate an alternate method for training AI models in Cloud Pak for Data, namely by using Jupyter notebook and open-source libraries. This is a very common and mostly preferred method by data scientists as it provides them with the utmost flexibility in exploring different algorithms for training best performing AI models.</p>
<ol>
<li>
<p>Go back to your project. Then click <strong>New asset +</strong> and select <strong>Jupyter notebook editor</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/AddJupyterNotebookAsset.png"></p>
</li>
<li>
<p>On the New notebook page, go to the <strong>Local file</strong> tab and click the <strong>Drag and drop files here or upload</strong>. Select the notebook that you downloaded before <a href="../assets/notebooks/churn_prediction_pyspark.ipynb">churn_prediction_pyspark.ipynb</a> to upload it. Then, select the runtime <strong>Default Spark 3.4 &amp; Python 3.10</strong> (we will be using PySpark to run this Notebook on CP4D). Finally, click <strong>Create</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/ChooseRuntime.png"></p>
<div class="admonition danger">
<p class="admonition-title">IMPORTANT</p>
<p><strong><em>DO NOT RUN THE NOTEBOOK YET</em></strong> A change is needed first to avoid all users from overiding other users' work.</p>
</div>
</li>
<li>
<p><strong><em>DO NOT RUN THE NOTEBOOK YET</em></strong>. First, review the notebook comments to get an idea of what the Notebook is going to do:</p>
<div class="admonition info">
<p class="admonition-title">Notebook Steps</p>
<ol>
<li>
<p><strong>Access the CUSTOMER_DATA_ready dataset</strong> from your project.</p>
</li>
<li>
<p>Process the data to <strong>prepare features</strong> relevant for the prediction.</p>
</li>
<li>
<p><strong>Train a Random Forest ML model</strong> to predict the likelihood of customers to churn using a sample of the data.</p>
</li>
<li>
<p><strong>Evaluate the model</strong> against test data not used in training.</p>
</li>
<li>
<p>Create the Deployment Space <strong>churnUATspace</strong> if it doesn't exist.</p>
</li>
<li>
<p>Associate Watson Machine Learning with the <em>churnUATspace</em> deployment space.</p>
</li>
<li>
<p><strong>Store the model</strong> in the <em>churnUATspace</em> deployment space</p>
</li>
<li>
<p><strong>Deploy the model</strong> in the <em>churnUATspace</em> deployment space.</p>
</li>
<li>
<p>Run a test to <strong>validate the online deployment</strong> of the model.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Go to the following lines and <strong>add your username</strong> to the MODEL_NAME and DEPLOYMENT_NAME variables:</p>
<ul>
<li>MODEL_NAME = "&lt;YourUser&gt; Churn Model"</li>
<li>DEPLOYMENT_NAME = "&lt;YourUser&gt; Churn Deployment"</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># Provide a target name for your churn model</span>
<span class="n">MODEL_NAME</span> <span class="o">=</span> <span class="s2">"&lt;YourUser&gt; Churn Model"</span>
<span class="c1"># Provide a target name for your churn model deployment</span>
<span class="n">DEPLOYMENT_NAME</span> <span class="o">=</span> <span class="s2">"&lt;YourUser&gt; Churn Deployment"</span>
</code></pre></div>
<p>For example, for user0:</p>
<p><img alt="Screenshot" src="../images/trainai/ModelName.png"></p>
</li>
<li>
<p>Now, run all the cells and review the output of each one.</p>
</li>
<li>
<p>If all cells ran successfully, your model should be deployed. Go to the Menu <strong>Deployments</strong>.</p>
<p><img alt="Screenshot" src="../images/trainai/Deployments.png"></p>
</li>
<li>
<p>On the Deployments page, go to the tab <strong>Spaces</strong> and click the <strong>churnUATspace</strong> space.</p>
<p><img alt="Screenshot" src="../images/trainai/churnUATSpace.png"></p>
</li>
<li>
<p>Go to tab <strong>Deployments</strong>. The model that you trained and deployed from the Jupyter Notebook is available for consumption.</p>
<p><img alt="Screenshot" src="../images/trainai/ModelAvailable.png"></p>
</li>
</ol>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>You've reached the end of this lab.</p>
</div></div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 IBM
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.top", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "navigation.instant", "content.code.copy", "toc.follow"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
    
  </body>
</html>